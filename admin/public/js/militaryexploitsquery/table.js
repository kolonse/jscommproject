var proxyData = null;
$(document).ready(function() {
    proxyData = $('#militaryexploitsquery-data').DataTable({
        scrollX: true,
        serverSide: true,
        autoWidth: true,
        dom: 'rtip',
        deferRender: true,
        ordering: true,
        language: DataTableLanguage,
        order: [
            [5, "desc"]
        ],
        ajax: {
            url: '/getData/mongo/militaryexploit',
            type: 'POST',
            data: function(v) {
                v.where = {};
                v.attr = ["data.roomid", "data.bulletvalue", "data.bulletcount", "data.playercount", "data.roundcount", "data.start", "data.end", "data.host", "data.gameinfo"];
            }
        },
        "columns": [
            { "data": "data.roomid" },
            { "data": "data.bulletvalue" },
            { "data": "data.bulletcount" },
            { "data": "data.playercount" },
            { "data": "data.roundcount" },
            {
                "data": "data.start",
                render: function(data) {
                    var time = moment(data);
                    return time.isValid() ? time.format("YYYY-MM-DD HH:mm:ss") : "invalid time";
                }
            },
            {
                "data": "data.end",
                render: function(data) {
                    var time = moment(data);
                    return time.isValid() ? time.format("YYYY-MM-DD HH:mm:ss") : "invalid time";
                }
            },
            { "data": "data.host" },
            {
                "data": "data.gameinfo",
                render: function(data) {
                    if (data instanceof Object) {
                        return JSON.stringify(data);
                    }
                    return data;
                }
            }
        ]
    });
    $('#militaryexploitsquery-data tbody').on('click', 'tr', function() {
        $(this).parent().children("tr").removeClass("selected");
        $(this).addClass('selected');
    });

    $('#militaryexploitsquery-data tbody').on('dblclick', 'tr', function() {
        $(this).parent().children("tr").removeClass("selected");
    });
});

function getSelectData() {
    return proxyData.row('.selected').data();
}